<!DOCTYPE busconfig PUBLIC "-//freedesktop//DTD D-BUS Bus Configuration 1.0//EN"
 "http://www.freedesktop.org/standards/dbus/1.0/busconfig.dtd">
<busconfig>
  <!-- Policy for dbus-mqtt-bridge user -->
  <policy user="dbus-mqtt-bridge">
    <!-- Allow connecting to the system bus -->
    <allow send_destination="org.freedesktop.DBus"/>
    <allow receive_sender="org.freedesktop.DBus"/>
    
    <!-- 
      IMPORTANT: The following policies are EXAMPLES ONLY.
      You MUST customize these based on your actual D-Bus mappings
      in /etc/dbus-mqtt-bridge/config.yaml
      
      For each dbus_to_mqtt mapping, add an appropriate receive rule.
      For each mqtt_to_dbus mapping, add an appropriate send rule.
    -->
    
    <!-- Example: Receive signals from NetworkManager -->
    <!-- Uncomment and adjust based on your config:
    <allow send_destination="org.freedesktop.NetworkManager"
           send_interface="org.freedesktop.NetworkManager"
           send_type="method_call"/>
    <allow receive_sender="org.freedesktop.NetworkManager"
           receive_interface="org.freedesktop.NetworkManager"
           receive_type="signal"/>
    -->
    
    <!-- Example: Call methods on systemd -->
    <!-- Uncomment and adjust based on your config:
    <allow send_destination="org.freedesktop.systemd1"
           send_interface="org.freedesktop.systemd1.Manager"
           send_type="method_call"
           send_member="StartUnit"/>
    <allow send_destination="org.freedesktop.systemd1"
           send_interface="org.freedesktop.systemd1.Manager"
           send_type="method_call"
           send_member="StopUnit"/>
    -->
    
    <!-- Example: Introspection (often needed) -->
    <!-- Uncomment if needed:
    <allow send_interface="org.freedesktop.DBus.Introspectable"/>
    <allow send_interface="org.freedesktop.DBus.Properties"/>
    -->
    
    <!-- Deny everything else by default -->
    <deny send_type="method_call"/>
    <deny send_type="signal"/>
  </policy>
  
  <!--
    SECURITY NOTE:
    This deny-by-default policy ensures that dbus-mqtt-bridge can only
    interact with D-Bus services explicitly permitted above. Review and
    audit these permissions carefully, especially before exposing MQTT
    to untrusted networks.
    
    To generate a policy from your config.yaml, run:
      dbus-mqtt-bridge-validate --generate-dbus-policy /etc/dbus-mqtt-bridge/config.yaml
    
    For more information, see:
      man dbus-mqtt-bridge
      man dbus-daemon
  -->
</busconfig>